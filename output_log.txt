��ʼ�����ļ�:
- װ�䵥: testfiles/original_packing_list.xlsx
- �����ļ�: testfiles/policy.xlsx
- ���Ŀ¼: outputs
Reading Excel file: testfiles/original_packing_list.xlsx
Skipping 2 rows as specified
Reading Excel file: testfiles/policy.xlsx
First 4 rows preview:
  Row 1: [1, 253.79, 452, 1.78100003940266, 0.05]...
Error reading with multi-level headers: header index 2 exceeds maximum index 1 of data.
Falling back to standard Excel reading...
Original packing list columns:
  ���
  �Ϻ�
  ��Ӧ��
  ��Ŀ����
  �����ص�
  ������ػ���
  ��Ӧ�̿�Ʊ����
  ��������
  �ͺ�
  ����
  ��λ
  ֽ��ߴ�
  �������
  �����
  ����ë��
  ��ë��
  ��������
  �ܾ���
  ÿ������
  �ܼ���
  ���
  ջ��ߴ�
  ջ����
  ���ڱ��ط�ʽ
  �ɹ���˾
  �ɹ����۲���˰
  ��Ʊ˰��
  Unnamed: 27

Verifying first 10 rows of data:
  Row 1: 1.0
  Row 2: 2.0
  Row 3: 3.0
  Row 4: 4.0
  Row 5: 5.0
  Row 6: 6.0
  Row 7: 7.0
  Row 8: 8.0
  Row 9: 9.0
  Row 10: 10.0

Packing List output columns defined:
['Sr No.', 'P/N.', 'DESCRIPTION', 'Model NO.', 'QUANTITY', 'CTNS', 'Carton MEASUREMENT', 'G.W (KG)', 'N.W(KG)', 'Carton NO.']

Finding column mappings...
Found column '���' for NO.
Found column '�Ϻ�' for Material code
WARNING: Could not find a column matching patterns ['Commercial Invoice Description', '���Ӣ�Ļ���(�����ṩ)', '����', 'description'] for DESCRIPTION
Found column '�ͺ�' for Model NO.
Found column '�ɹ����۲���˰' for Unit Price
Found column '����' for Qty
Found column '��λ' for Unit
Found column '��������' for net weight
Found column '����ë��' for gross weight
Found column '�����ص�' for factory
Found column '��Ŀ����' for project
WARNING: Could not find a column matching patterns ['end use', '��;'] for end use
Found column '�ܼ���' for CTNS
Found column '�����' for Carton MEASUREMENT
Found column '���' for Carton NO.
Found column '���ڱ��ط�ʽ' for Trade Type
WARNING: Description column not found, using Material code as Description
Successfully mapped project column from '��Ŀ����'

Column mappings summary:

Found column mappings:
  NO. <- ���
  Material code <- �Ϻ�
  Model NO. <- �ͺ�
  Unit Price <- �ɹ����۲���˰
  Qty <- ����
  Unit <- ��λ
  net weight <- ��������
  factory <- �����ص�
  project <- ��Ŀ����

Missing column mappings:
  DESCRIPTION - No matching column found in the source file
  end use - No matching column found in the source file

Found 11 out of 11 expected column mappings (100.0%)

Found net weight column: ��������
Sample net weight values:
  Row 1: 2.6
  Row 2: 1.1
  Row 3: 0.5
  Row 4: 0.2
  Row 5: 1.55

ó������ͳ�ƣ�
  һ��ó����������: 61
  ��ó����������: 0
Converted net weight to numeric. Example values: 0    2.60
1    1.10
2    0.50
3    0.20
4    1.55
Name: net weight, dtype: float64
Total net weight calculated: 3428.56 kg
�����ļ�ʱ����: 'gbk' codec can't encode character '\xa5' in position 9: illegal multibyte sequence
Traceback (most recent call last):
  File "D:\project\export_reimport\process_shipping_list.py", line 1658, in <module>
    result = process_shipping_list(packing_list_file, policy_file, args.output_dir)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\project\export_reimport\process_shipping_list.py", line 943, in process_shipping_list
    print(f"  �ܼ�FOB: \xa5{totalFOB:.4f}")
UnicodeEncodeError: 'gbk' codec can't encode character '\xa5' in position 9: illegal multibyte sequence

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\project\export_reimport\process_shipping_list.py", line 1671, in <module>
    print(f"����λ��: {traceback.format_exc().splitlines()[-2]}")
UnicodeEncodeError: 'gbk' codec can't encode character '\xa5' in position 27: illegal multibyte sequence
